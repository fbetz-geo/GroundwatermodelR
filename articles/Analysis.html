<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GroundwatermodelR">
<title>How to use GroundwatermodelR to conduct analysis with existing raster time series • GroundwatermodelR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use GroundwatermodelR to conduct analysis with existing raster time series">
<meta property="og:description" content="GroundwatermodelR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GroundwatermodelR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Analysis.html">How to use GroundwatermodelR to conduct analysis with existing raster time series</a>
    <a class="dropdown-item" href="../articles/PredictoR.html">Predictions for new data based on existing model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to use GroundwatermodelR to conduct analysis with existing raster time series</h1>
            
      
      
      <div class="d-none name"><code>Analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installing-the-groundwatermodelr-package">Installing the GroundwatermodelR package<a class="anchor" aria-label="anchor" href="#installing-the-groundwatermodelr-package"></a>
</h2>
<p>This tutorial describes how to obtain a time series for specific
locations from a raster time series using the GroundwatermodelR package.
This package is a collection of functions to create spatial-temporal
interpolations of groundwater level data (or similar) and work with the
resulting raster data. The package is available from github and can
easily be installed using the remotes package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(remotes)</span></span>
<span><span class="co">#install_github("fbetz-geo/GroundwatermodelR")</span></span>
<span><span class="co">#library(GroundwatermodelR)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-data-from-existing-raster-time-series">Extracting data from existing raster time series<a class="anchor" aria-label="anchor" href="#extracting-data-from-existing-raster-time-series"></a>
</h2>
<p>One aim of analysis is often to assess groundwater level or
groundwater distance data for a specific location, e.g. vegetation
monitoring plots. Betz and Fischer, in prep. have presented the idea of
‘virtual gauges’ to extract a single time series from a raster time
series to solve this. In the GroundwatermodelR package, the idea of
virtual gauges is implemented in the extractR function. It takes a
directory of with raster files (one file per time step) as input and
extracts a single time series per location. In the simple case, the
locations are given as points, in this case, the extraction is
straightforward.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Get the paths to the input raster files and locations of interest</span></span>
<span><span class="co">#raster_dir&lt;-"C:/Users/Documents/Your_Data"</span></span>
<span><span class="co">#loc&lt;-"C:/Users/Documents/Your_points.gpkg"</span></span>
<span></span>
<span><span class="co">#If you wish to return single txt files </span></span>
<span><span class="co">#extractR(raster_dir=raster_dir,loc=loc,out_dir=out_dir,raster_type = "tif")</span></span></code></pre></div>
<p>GroundwatermodelR offers two output formats for the data. Setting
out_type=“df” returns a data.frame containing the values of all
locations in long format.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#df&lt;-extractR(raster_dir=raster_dir,loc=loc,out_type="df",name_col="Name")</span></span>
<span><span class="co">#head(df)</span></span></code></pre></div>
<p>Alternatively, it is also possible to return one csv file for each
location containing the entire time series. This is convenient, if you
consider to hand over the data to other users not experienced with R or
if you simply wish to store the data for later use. The file names will
include the name of the location taken from the name attribute column in
the input locations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Specify output directory</span></span>
<span><span class="co">#out_dir&lt;-"C:/Users/Documents/Your_output_directory</span></span>
<span></span>
<span><span class="co">#Extract data and write to file</span></span>
<span><span class="co">#extractR(raster_dir=raster_dir,loc=loc,out_type="export",out_dir=out_dir,name_col="Name",dec=",")</span></span></code></pre></div>
<div class="section level3">
<h3 id="dealing-with-polygons-as-area-of-interest">Dealing with polygons as area of interest<a class="anchor" aria-label="anchor" href="#dealing-with-polygons-as-area-of-interest"></a>
</h3>
<p>Such area typically contains a number of pixels of the groundwater
level raster dataset. In GroundwatermodelR, there are two options to
deal with this case:</p>
<div class="section level4">
<h4 id="obtaining-one-point-within-the-area">1 Obtaining one point within the area<a class="anchor" aria-label="anchor" href="#obtaining-one-point-within-the-area"></a>
</h4>
<p>First, we could select one single point within each area (monitoring
plot). In the easiest way, we use the centroid of a polygon, but we
might also use the lowest or highest point in order to represent terrain
conditions in a desired way. GroundwatermodelR offers the plotfindR
function for this. For instance, we can find the lowest point in each
vegetation monitoring plot in a vector dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Add sample data to the package and demonstrate loading!</span></span>
<span><span class="co">#dem&lt;-</span></span>
<span><span class="co">#loc&lt;-</span></span>
<span><span class="co">#plot(st_geometry(loc))</span></span>
<span></span>
<span><span class="co">#Use plotfindR function to get lowest point of each sampling plot</span></span>
<span><span class="co">#loc_points&lt;-plotfindR(dem=dem,loc=loc,mode="lowest")</span></span>
<span><span class="co">#plot(st_geometry(loc_points))</span></span></code></pre></div>
<p>Alternatively, plotfindR can also return the heighest point of the
plot or simply the centroid. Reducing the polygon representation of
sampling plots to points can significantly speed up the extraction of
time series extraction from the raster time series when using the
extractR function. Once polygons are converted to points, they can
simply be used as input for the extractR function.</p>
</div>
<div class="section level4">
<h4 id="using-the-entire-polygon-and-obtain-statistics">2 Using the entire polygon and obtain statistics<a class="anchor" aria-label="anchor" href="#using-the-entire-polygon-and-obtain-statistics"></a>
</h4>
<p>Alternatively, it is possible to use the polygons as input for
extractR, the function will automatically recognize the input geometry
type. In this case, extractR will return basic statistics (similar to
summary()) for each timestep. This tends to be slower as it needs to
extract a number of values per timestep and handle it. However, it
allows to get more information out of the data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#raster_dir&lt;-"C:/Users/Documents/Your_Data"</span></span>
<span><span class="co">#out_dir&lt;-"C:/Users/Documents/Your_output_data"</span></span>
<span><span class="co">#df&lt;-extractR(raster_dir=raster_dir,loc=loc,out_dir=out_dir,)</span></span></code></pre></div>
<p>Again, it is possible to use the extractR function to return a
data.frame or to write the results to file (out_type=“export”).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="further-processing-of-the-results">Further processing of the results<a class="anchor" aria-label="anchor" href="#further-processing-of-the-results"></a>
</h2>
<p>GroundwatermodelR includes some functionalities to further handle the
resulting time series from the different locations. Please note, that
this works only for single values per timestep and not with the summary
statistic tables resulting from extractions with polygons. A basic
analysis is the temporal aggregation of the times series, e.g. from
daily to yearly. Currently, only yearly aggregation is supported.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#agg&lt;-aggregatoR(df,time_col="Date",time_format="%Y-%m-%d",stat_col="gwl",statistic=mean,Summary=FALSE,season=FALSE)</span></span>
<span><span class="co">#head(agg)</span></span></code></pre></div>
<p>The season argument declares whether the aggregatoR function takes
the entire year as input or uses a seasonal subset only. This seasonal
aggregation option can be of interest when analyzing e.g. groundwater
levels during vegetation season.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#agg&lt;-aggregatoR(df,time_col="Date",time_format="%Y-%m-%d",stat_col="gwl", season=TRUE, doy=c(74:180))</span></span>
<span><span class="co">#head(agg)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Florian Betz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
